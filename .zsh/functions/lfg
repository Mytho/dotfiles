# LFG
# ---
#
# Less +F Grep (LFG) makes grepping a continuous stream possible.

LOG=$1

shift

PATTERN=$@
DIR="/tmp/lessfgrep"
FILE="$DIR/$(basename $LOG)"

[ ! -d $DIR ] && mkdir $DIR

trap 'rm -rf "$DIR";' INT TERM EXIT
( tail -n 0 -f "$LOG" | grep --line-buffered $PATTERN ) > "$FILE" | less +F "$FILE"
trap - INT TERM EXIT
